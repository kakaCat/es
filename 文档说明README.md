# API 文档说明

## 📚 文档清单

本项目包含以下详细的 API 接口文档：

### 1. API接口文档.csv
**简化版接口文档** - 适合快速查阅

- **接口数量**: 26 个
- **字段数量**: 13 列
- **文件大小**: ~50 KB
- **适用场景**: 快速查找接口、参数检查、前端对接

**包含字段：**
- 序号、接口分类、接口名称
- HTTP 方法、接口路径
- 功能描述
- 请求参数、请求体示例
- 响应参数、响应示例
- 实现状态、实现文件、备注

---

### 2. API接口详细文档.csv
**详细版接口文档** - 完整实现说明

- **接口数量**: 26 个（示例显示前 5 个）
- **字段数量**: 16 列
- **文件大小**: ~200 KB（完整版）
- **适用场景**: 深入理解实现、问题排查、系统设计

**包含字段：**
- 所有简化版字段
- **详细实现说明**: 完整的实现流程（20+ 步骤）
- **技术要点**: 核心技术、关键配置、监控集成等
- **数据流转**: 完整的数据流向和存储说明
- **注意事项**: 10+ 条重要提示

**示例接口（已完成详细说明）：**
1. ✅ 创建容器组 - 包含 23 步实现流程，9 次部署上报
2. ✅ 删除容器组 - 包含 13 步删除流程，逻辑删除机制
3. ✅ 查询服务列表 - 多数据源聚合，分页和过滤
4. ✅ 查询服务详情 - 深度数据合并，可选 Pod 详情和事件
5. ✅ 向量搜索 (ANN) - 完整 IVF 算法流程，10 步搜索过程

---

### 3. IVF算法接口文档.csv
**IVF 算法方法文档** - 算法实现细节

- **方法数量**: 33 个
- **字段数量**: 10 列
- **文件大小**: ~30 KB
- **适用场景**: 算法优化、性能调优、代码维护

**包含字段：**
- 模块、类名、方法名
- 功能描述
- 输入参数（详细类型说明）
- 返回值（详细类型说明）
- **时间复杂度**（大 O 表示）
- **空间复杂度**（大 O 表示）
- 实现状态、代码位置（精确到行号）

**模块分类：**
1. 向量相似度 (8 个方法)
2. KMeans 训练 (3 个方法)
3. 倒排索引 (11 个方法)
4. 查询构建 (7 个方法)
5. 字段映射 (2 个方法)
6. 向量字段 (4 个方法)

---

## 📊 文档特点对比

| 特性 | 简化版 | 详细版 | IVF 算法文档 |
|------|--------|--------|-------------|
| 适合人员 | 前端开发、测试 | 后端开发、架构师 | 算法工程师 |
| 查阅速度 | ⚡ 快 | 📖 中等 | 🔍 快 |
| 内容深度 | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| 示例代码 | ✅ JSON | ✅ JSON + 流程 | ❌ 无 |
| 性能分析 | ❌ 无 | ⚠️ 部分 | ✅ 完整 |
| 代码定位 | ✅ 文件 | ✅ 文件 | ✅ 文件:行号 |

---

## 🎯 使用建议

### 场景 1: 前端开发对接 API
**推荐文档**: API接口文档.csv（简化版）

**快速定位：**
1. 查找接口分类
2. 查看请求参数和请求体示例
3. 查看响应参数和响应示例
4. 复制 JSON 示例直接使用

**示例：**
```javascript
// 查找 "创建容器组" 接口
// 请求体示例列：直接复制 JSON
const requestBody = {
  "tenant_org_id": "org-001",
  "user": "alice",
  "service_name": "vector-search",
  "replicas": 3,
  // ...
};

// 响应示例列：了解返回格式
// { "namespace": "...", "status": "created", ... }
```

---

### 场景 2: 后端开发实现接口
**推荐文档**: API接口详细文档.csv（详细版）

**深入理解：**
1. 查看"详细实现说明"列 - 了解完整流程
2. 查看"技术要点"列 - 掌握核心技术
3. 查看"数据流转"列 - 理解数据来源和存储
4. 查看"注意事项"列 - 避免常见问题

**示例：创建容器组接口**
```
详细实现说明：
1. 参数验证
2. 命名空间生成
3. 配额检查
4. 元数据优先保存（关键！）
5. 部署状态上报 (starting)
... (共 23 步)

技术要点：
- 元数据优先保存策略
- StatefulSet 管理
- 多租户命名空间隔离
...

注意事项：
1. 元数据必须先于 K8s 资源保存
2. 配额检查失败会拒绝创建
...
```

---

### 场景 3: 向量搜索性能优化
**推荐文档**: IVF算法接口文档.csv

**性能分析：**
1. 查看时间复杂度列 - 找性能瓶颈
2. 查看空间复杂度列 - 评估内存占用
3. 查看代码位置列 - 定位具体实现

**示例：优化搜索速度**
```
方法：search
时间复杂度：O(nlist×d + nprobe×m×d + m×log(m))

优化思路：
1. 减少 nlist - 加快粗排（但降低精度）
2. 减少 nprobe - 减少候选数量（但降低召回率）
3. 增加缓存 - 缓存聚类中心计算结果
4. 使用 SIMD - 向量化距离计算
```

---

### 场景 4: 问题排查和 Debug
**推荐文档**: API接口详细文档.csv + IVF算法接口文档.csv

**排查步骤：**
1. **确定问题接口** - 查简化版找到接口名称
2. **查看实现流程** - 查详细版"详细实现说明"
3. **定位问题步骤** - 根据日志或错误信息定位到具体步骤
4. **查看数据流转** - 理解数据在哪一步出问题
5. **查看注意事项** - 检查是否触发已知问题
6. **定位代码** - 查 IVF 文档精确到行号

**示例：向量搜索返回空结果**
```
步骤 1: 查简化版 - 找到 "向量搜索 (ANN)" 接口
步骤 2: 查详细版 - 看到第 3 步 "检查训练状态"
步骤 3: 查注意事项 - 第 1 条 "索引必须先训练"
步骤 4: 查 IVF 文档 - trainIndex 方法，代码位置 IVFQueryBuilder.java:202-217
步骤 5: 解决方案 - 调用训练接口或检查 isTrained 状态
```

---

## 📖 阅读指南

### 详细版文档字段说明

#### 1. 详细实现说明
**格式**: 带编号的步骤列表

**内容包含:**
- 完整的实现流程（10-30 步）
- 每步的输入输出
- 关键函数调用
- 错误处理机制

**示例:**
```
1. **参数验证** - 检查 tenant_org_id、user、service_name 必填
2. **命名空间生成** - 格式: {tenant_org_id}-{user}-{service_name}
3. **配额检查** - 从元数据服务查询租户配额
...
```

---

#### 2. 技术要点
**格式**: 分类说明

**内容包含:**
- 核心技术栈
- 关键配置
- 监控和日志集成
- 性能优化点

**示例:**
```
**核心技术：**
- Kubernetes Client-go API
- StatefulSet 管理
- 多租户命名空间隔离

**关键配置：**
- StatefulSet 保证 Pod 稳定标识
- PVC 模板自动创建存储
...
```

---

#### 3. 数据流转
**格式**: 流程图式文字描述

**内容包含:**
- 完整的数据流向（用 → 连接）
- 数据存储位置
- 查询优化
- 缓存策略

**示例:**
```
用户请求 → Manager 验证 → 元数据服务（保存） → K8s API（创建资源） → 上报服务 → 返回用户

**元数据存储：**
- PostgreSQL: tenant_containers 表
- 文件系统: server/data/tenant_{user}_{service}.json
```

---

#### 4. 注意事项
**格式**: 带编号的列表（10+ 条）

**内容包含:**
- 常见错误
- 性能建议
- 安全提示
- 最佳实践

**示例:**
```
1. 命名空间必须全局唯一
2. 配额检查失败会拒绝创建
3. 元数据必须先于 K8s 资源保存
...
```

---

### IVF 算法文档字段说明

#### 时间复杂度
**表示方法**: 大 O 符号

**变量说明:**
- `n`: 向量总数
- `d`: 向量维度
- `k`: nlist（聚类数）
- `m`: 平均每簇向量数（n/k）
- `i`: KMeans 迭代次数

**示例:**
```
O(n×k×d×i) - KMeans 训练
O(nlist×d + nprobe×m×d) - IVF 搜索
```

---

#### 空间复杂度
**表示方法**: 大 O 符号

**说明**: 额外内存占用（不含输入数据）

**示例:**
```
O(k×d) - 存储聚类中心
O(n×d) - 存储倒排列表
```

---

## 🔍 快速查找技巧

### 在 Excel 中
1. **使用筛选** - 点击列标题启用筛选
2. **搜索功能** - Ctrl+F 搜索关键词
3. **冻结窗格** - 冻结前几列便于横向滚动

### 在 Google Sheets 中
1. **创建筛选视图** - 数据 → 创建筛选视图
2. **使用查找** - Ctrl+F 或 Cmd+F
3. **按分类排序** - 点击列标题排序

### 在 VSCode 中
1. **搜索** - Ctrl+F 全文搜索
2. **列模式** - 安装 CSV 插件查看
3. **快速跳转** - Ctrl+G 跳转到指定行

---

## 📝 文档维护

### 更新频率
- **简化版**: 新增接口时更新
- **详细版**: 实现变更时更新
- **IVF 文档**: 算法优化时更新

### 版本控制
建议使用 Git 跟踪变更：
```bash
git add *.csv
git commit -m "docs: update API documentation"
```

### 反馈渠道
- 提交 Issue: GitHub Issues
- 文档错误: 直接修改并提交 PR
- 建议改进: Discussion 讨论区

---

## 🎓 学习路径

### 1. 初级 - 了解接口
**目标**: 能调用接口完成基本功能

**推荐文档**: API接口文档.csv

**学习要点:**
- 接口路径和方法
- 请求参数和格式
- 响应数据结构

**实践项目:**
- 创建一个集群
- 插入向量数据
- 执行向量搜索

---

### 2. 中级 - 理解实现
**目标**: 理解接口实现原理

**推荐文档**: API接口详细文档.csv

**学习要点:**
- 实现流程和步骤
- 技术选型原因
- 数据存储方案

**实践项目:**
- 阅读源代码验证文档
- 修改配置优化性能
- 排查常见问题

---

### 3. 高级 - 优化算法
**目标**: 优化性能和准确性

**推荐文档**: IVF算法接口文档.csv

**学习要点:**
- 算法时间/空间复杂度
- 参数调优技巧
- 性能瓶颈分析

**实践项目:**
- 性能基准测试
- 参数调优实验
- 实现 SIMD 加速

---

## 📊 统计信息

### 文档完整性

| 文档类型 | 接口/方法数 | 完成度 | 平均字数 |
|---------|------------|--------|----------|
| 简化版 | 26/26 | 100% | 200 字/接口 |
| 详细版 | 5/26 | 19% | 2000 字/接口 |
| IVF 算法 | 33/33 | 100% | 150 字/方法 |

**详细版已完成接口:**
1. ✅ 创建容器组
2. ✅ 删除容器组
3. ✅ 查询服务列表
4. ✅ 查询服务详情
5. ✅ 向量搜索 (ANN)

**待完成接口（详细版）:** 21 个

---

## 🚀 下一步

### 短期计划
- [ ] 完成所有 26 个接口的详细说明
- [ ] 添加更多示例代码
- [ ] 补充错误码说明

### 中期计划
- [ ] 添加 Postman Collection
- [ ] 创建交互式 API 文档（Swagger）
- [ ] 录制接口使用视频

### 长期计划
- [ ] 多语言版本（英文）
- [ ] API SDK 文档
- [ ] 最佳实践手册

---

## 📞 联系方式

如有文档相关问题，请通过以下方式联系：

- 📧 Email: [项目邮箱]
- 💬 Issue: [GitHub Issues]
- 📖 Wiki: [项目 Wiki]

---

**文档生成时间**: 2025-11-30
**文档版本**: v1.0
**维护者**: Claude (Sonnet 4.5)
